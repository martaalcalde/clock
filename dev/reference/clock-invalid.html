<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This family of functions is for working with invalid calendar dates.
Invalid dates represent dates made up of valid individual components, which
taken as a whole don't represent valid calendar dates. For example, for
year_month_day() the following component ranges are valid:
year: [-32767, 32767], month: [1, 12], day: [1, 31].
However, the date 2019-02-31 doesn't exist even though it is made up
of valid components. This is an example of an invalid date.
Invalid dates are allowed in clock, provided that they are eventually
resolved by using invalid_resolve() or by manually resolving them through
arithmetic or setter functions."><title>Invalid calendar dates — clock-invalid • clock</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.6/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.6/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Invalid calendar dates — clock-invalid"><meta property="og:description" content="This family of functions is for working with invalid calendar dates.
Invalid dates represent dates made up of valid individual components, which
taken as a whole don't represent valid calendar dates. For example, for
year_month_day() the following component ranges are valid:
year: [-32767, 32767], month: [1, 12], day: [1, 31].
However, the date 2019-02-31 doesn't exist even though it is made up
of valid components. This is an example of an invalid date.
Invalid dates are allowed in clock, provided that they are eventually
resolved by using invalid_resolve() or by manually resolving them through
arithmetic or setter functions."><meta property="og:image" content="https://clock.r-lib.org/logo.png"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="clock.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">clock</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.6.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/clock.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/motivations.html">Motivations for clock</a>
    <a class="dropdown-item" href="../articles/faq.html">Frequently Asked Questions</a>
    <a class="dropdown-item" href="../articles/recipes.html">Examples and Recipes</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/03/clock-0-1-0/">Version 0.1.0</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-lib/clock/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Invalid calendar dates</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/clock/blob/HEAD/R/invalid.R" class="external-link"><code>R/invalid.R</code></a></small>
      <div class="d-none name"><code>clock-invalid.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This family of functions is for working with <em>invalid</em> calendar dates.</p>
<p>Invalid dates represent dates made up of valid individual components, which
taken as a whole don't represent valid calendar dates. For example, for
<code><a href="year_month_day.html">year_month_day()</a></code> the following component ranges are valid:
<code>year: [-32767, 32767]</code>, <code>month: [1, 12]</code>, <code>day: [1, 31]</code>.
However, the date <code>2019-02-31</code> doesn't exist even though it is made up
of valid components. This is an example of an invalid date.</p>
<p>Invalid dates are allowed in clock, provided that they are eventually
resolved by using <code>invalid_resolve()</code> or by manually resolving them through
arithmetic or setter functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">invalid_detect</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">invalid_any</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">invalid_count</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">invalid_remove</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">invalid_resolve</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, invalid <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p><code>[calendar]</code></p>
<p>A calendar vector.</p></dd>


<dt>...</dt>
<dd><p>These dots are for future extensions and must be empty.</p></dd>


<dt>invalid</dt>
<dd><p><code>[character(1) / NULL]</code></p>
<p>One of the following invalid date resolution strategies:</p><ul><li><p><code>"previous"</code>: The previous valid instant in time.</p></li>
<li><p><code>"previous-day"</code>: The previous valid day in time, keeping the time of
day.</p></li>
<li><p><code>"next"</code>: The next valid instant in time.</p></li>
<li><p><code>"next-day"</code>: The next valid day in time, keeping the time of day.</p></li>
<li><p><code>"overflow"</code>: Overflow by the number of days that the input is invalid
by. Time of day is dropped.</p></li>
<li><p><code>"overflow-day"</code>: Overflow by the number of days that the input is
invalid by. Time of day is kept.</p></li>
<li><p><code>"NA"</code>: Replace invalid dates with <code>NA</code>.</p></li>
<li><p><code>"error"</code>: Error on invalid dates.</p></li>
</ul><p>Using either <code>"previous"</code> or <code>"next"</code> is generally recommended, as these
two strategies maintain the <em>relative ordering</em> between elements of the
input.</p>
<p>If <code>NULL</code>, defaults to <code>"error"</code>.</p>
<p>If <code>getOption("clock.strict")</code> is <code>TRUE</code>, <code>invalid</code> must be supplied and
cannot be <code>NULL</code>. This is a convenient way to make production code robust
to invalid dates.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<ul><li><p><code>invalid_detect()</code>: Returns a logical vector detecting invalid dates.</p></li>
<li><p><code>invalid_any()</code>: Returns <code>TRUE</code> if any invalid dates are detected.</p></li>
<li><p><code>invalid_count()</code>: Returns a single integer containing the number of
invalid dates.</p></li>
<li><p><code>invalid_remove()</code>: Returns <code>x</code> with invalid dates removed.</p></li>
<li><p><code>invalid_resolve()</code>: Returns <code>x</code> with invalid dates resolved using the
<code>invalid</code> strategy.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Invalid dates must be resolved before converting them to a time point.</p>
<p>It is recommended to use <code>"previous"</code> or <code>"next"</code> for resolving invalid
dates, as these ensure that <em>relative ordering</em> among <code>x</code> is maintained.
This is a often a very important property to maintain when doing time series
data analysis. See the examples for more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Invalid date</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">04</span>, <span class="fl">30</span><span class="op">:</span><span class="fl">31</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">30</span>, <span class="fl">00</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;year_month_day&lt;second&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2019-04-30T03:30:00" "2019-04-31T02:30:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">invalid_detect</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE  TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Previous valid moment in time</span></span></span>
<span class="r-in"><span><span class="va">x_previous</span> <span class="op">&lt;-</span> <span class="fu">invalid_resolve</span><span class="op">(</span><span class="va">x</span>, invalid <span class="op">=</span> <span class="st">"previous"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x_previous</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;year_month_day&lt;second&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2019-04-30T03:30:00" "2019-04-30T23:59:59"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Previous valid day, retaining time of day</span></span></span>
<span class="r-in"><span><span class="va">x_previous_day</span> <span class="op">&lt;-</span> <span class="fu">invalid_resolve</span><span class="op">(</span><span class="va">x</span>, invalid <span class="op">=</span> <span class="st">"previous-day"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x_previous_day</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;year_month_day&lt;second&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2019-04-30T03:30:00" "2019-04-30T02:30:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that `"previous"` retains the relative ordering in `x`</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">x_previous</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">x_previous</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># But `"previous-day"` here does not!</span></span></span>
<span class="r-in"><span><span class="va">x_previous_day</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">x_previous_day</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Remove invalid dates entirely</span></span></span>
<span class="r-in"><span><span class="fu">invalid_remove</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;year_month_day&lt;second&gt;[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2019-04-30T03:30:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="year_quarter_day.html">year_quarter_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span>, <span class="fl">90</span><span class="op">:</span><span class="fl">92</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;year_quarter_day&lt;January&gt;&lt;day&gt;[3]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2019-Q1-90" "2019-Q1-91" "2019-Q1-92"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Overflow rolls forward by the number of days between `y` and the previous</span></span></span>
<span class="r-in"><span><span class="co"># valid date</span></span></span>
<span class="r-in"><span><span class="fu">invalid_resolve</span><span class="op">(</span><span class="va">y</span>, invalid <span class="op">=</span> <span class="st">"overflow"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;year_quarter_day&lt;January&gt;&lt;day&gt;[3]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2019-Q1-90" "2019-Q2-01" "2019-Q2-02"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

  </div></footer></body></html>

